自动化应用
Automation Application
第 66 卷 第 5 期 2025 年 3 月
Vol.66 No.5 Mar.2025
轮腿式平衡机器人的控制系统
葛畅畅,孟鸿儒,张余浩,蓝 昀,俞天鹏,张 鹏,陈劲松
(江苏海洋大学创新创业学院,江苏 连云港 222005)
摘 要:主要介绍了轮腿式平衡机器人的数学模型,采用线性二次型调节器(LQR)算法设计了轮式运动控制器,采 用虚拟模型控制(VMC)算法设计了腿部运动控制器。设计过程均是先根据动力学方程建立控制模型,再使用 Simulink 搭建控制方框图进行仿真计算,最后根据仿真结果调整控制参数,分析本系统在该参数下的控制效果,以保障机器人 在各个高度下均能实现良好的控制效果。轮腿式平衡机器人采用轮腿构型,可在具有轮驱的高能效优点的同时收获腿 带来的良好地形适应性,能极大程度提升倒立摆机器人的运动表现。 关键词:五连杆式轮腿结构;运动控制;算法;平衡稳定;MATLAB Simulink;线性二次型调节器
中图分类号:TP242 文献标识码:A DOI:10.19769/j.zdhy.2025.05.010
Control System of Wheel-Legged Balance Robot
GE Changchang,MENG Hongru,ZHANG Yuhao,LAN Yun,YU Tianpeng,ZHANG Peng,CHEN Jinsong
(College of Innovation and Entrepreneurship,Jiangsu Ocean University,Lianyungang,Jiangsu 222005,China)
Abstract:This paper primarily introduces the mathematical model of a wheel-legged balance robot. It designs a wheel motion
controller using the Linear Quadratic Regulator(LQR)algorithm and a leg motion controller utilizing the Virtual Model Control
(VMC)algorithm. Both design processes begin by establishing a control model based on dynamic equations,then proceed to set
up control block diagrams in Simulink for simulation calculations. Finally,according to the simulation results,control
parameters are adjusted to analyze the control effectiveness of the system under those parameters,ensuring that the robot
achieves optimal control performance at various heights. The wheel-legged balance robot adopts a wheel-legged configuration. It
can inherit the high energy efficiency of wheel-driven systems while gaining the exceptional terrain adaptability provided by
legs,significantly enhancing the motion performance of the inverted pendulum robot.
Key words:five-link wheel-legged structure;motion control;balance and stability;MATLAB Simulink;LQR
0 引言
近年来,机器人轮足式运动的概念源于人们希望创造 能够在复杂和非结构化环境中导航的多模态理念,类似于 部分多足虫类在各种地形中移动的方式。多模式轮足机器 人的概念结合了轮式和腿式的运动能力,代表了机器人领 域相对较新的发展方向,其发展本质上是为了满足机器人 在各种环境中灵活适应的需求。 人们在研究中对能够穿越不同地形并处理各种任务 的机器人的渴望,推动了多模态机器人的发展。研究者发 现,轮式运动在光滑的表面上非常有效,而腿式运动在崎 岖或不平坦的地形上提供了更好的机动性[1]。 机器人的控制策略需建立在数学模型的基础上,机构 的运动学分析和动力学分析是机构综合和实时控制的基
础,全面和完整的建模有助于设计控制器并提高机器人的 性能。从已有的研究发现,在两轮机器人系统研究初期,针 对机器人系统模型建立方向的研究比较热门。在机器人模 型的建立上,主要有两种基本方法:一种是基于动力学的 建模方法[2],另一种是采用黑盒模型的建模方法[3]。 本文主要介绍动力学模型,通过牛顿欧拉方法进行动 力学建模时,需要根据机器人系统中的惯性力、重力、关节 力等因素描述机器人的动力学行为。由于考虑了关节力的 相互作用,因此该模型具有建模精度高、计算效率高、数据 稳定性好的优点[4]。
1 动力学建模
轮腿式双足机器人的全身运动可解耦为轮式运动和 腿部运动。轮式运动包括平面运动(机体平衡、前后移动) 和转向运动。腿部运动包括跳跃运动、高度调节运动以及
作者简介:葛畅畅,女,2003 年生,研究方向为电子自动化。
· 30 ·


自动化应用
第 5 期 自动控制系统
地面自适应运动。
1.1 轮式运动——倒立摆模型
对于机器人的轮式运动,可作如下理想化假设:机体 的质量等效集中于质心位置;忽略腿部运动对轮式运动的 影响;忽略腿部连杆的质量;驱动轮与地面为无滑动的滚 动摩擦。 基于以上理想化假设,可将轮腿式平衡机器人的轮式运 动等效简化为摆长可变的双轮倒立摆模型,如图 1、图 2所示。
图 1 双轮倒立摆模型 图 2 驱动轮简化模型
1.2 经典力学分析
驱动轮在 x 方向的力平衡方程为: m
w x = FL - NL (1)
I
w
Rx =T-FL R (2)
合并式(1)和式(2),消去 FL,得到 x 的表达式为:
x= T-NLR
I
Rw + mw R
(3)
对摆杆,有:
N
L-Nx=mp
∂2
∂t2(x+L sin θ) (4)
P
L-Py-mp g=mp
∂2
∂t2(L cos θ) (5)
I
pθ=(PL L + Py LM)sin θ-(NL L + Nx Lm)cos θ- T + Tp (6) 对机体,有:
Nx = M ∂2
∂t2(x+(L+LM)sin θ-l sin φ) (7)
Py - Mg = M ∂2
∂t2((L+LM)cos θ+l cos φ) (8)
I
M φ =Tp+NM l cos φ+Py l sin φ (9) 机器人的模型参数如表 1 所列。
表 1 机器人模型参数
符号
mw mp M
Iw Ip
IM
R L
LM
l
含义 驱动轮转子质量 摆杆质量 机体质量 驱动轮转子转动惯量 摆杆绕质心转动惯量 机体绕质心转动惯量 驱动轮半径 摆杆重心到驱动轮轴距离 摆杆重心到机体转轴距离 机体重心到其转轴距离
单位 kg kg kg kg·m2 kg·m2 kg·m2 m m m m
2 LQR 算法
2.1 LQR 建模分析
根据轮腿的倒立摆模型,设定一个反馈矩阵 K:
K=■■|| ■■||
k
11 k12 k13 k14 k15 k16
k
21 k22 k23 k24 k25 k26
(10)
令 μ=-KZ,则 Z=AZ-BKZ=(A-BK)Z。将 A-BK 命 名 为 Acl 矩阵,通过改变反馈矩阵 K 的各项参数,可使 Acl 矩 阵的特征值全部非正,以使系统稳定。 针对如何配置极点使系统性能最优的问题,本文为线
性二次型调节器(Linear Quadratic Regulator,LQR)[5]引入 了代价函数:
J=∫0
+∞(ZTQZ + μT Rμ)dt (11)
其目的是通过调节状态反馈控制器 μ=-KZ,使代价 函数取得最小值 Jmin。在此过程中,Q 和 R 表示需要设计的 半正定矩阵和正定矩阵,Q 矩阵表示对于状态变量 Z 的惩 罚,R 矩阵表示对于输入量 μ 的惩罚。Q 矩阵的某一分量值 越大,对应的状态变量衰减至 0 的速度越快;R 矩阵的分 量则用于限制对应输入量 μ 的大小。 反馈矩阵 K 的计算公式为:
K = R-1 BT P (12) 其中,P 矩阵由 Riccati 方程解得: A
T P + PA+ Q - PBR-1 BT P =0 (13) 通过上述方法即可在线性化平衡点附近实现系统稳 定。代入相应的 Q 矩阵和 R 矩阵进行计算则能够得到反馈 矩阵 K。
2.2 MATLAB 建模
在 Simulink 中搭建轮式运动的仿真控制模型,具体如 图 3 所示。
图 3 轮式运动的 Simulink 仿真控制模型
将 MATLAB Simulink 仿真得到的反馈矩阵 K 的参数 代入仿真模型中,并设定初始俯仰角为 20°,以模拟机器 人从远离平衡点的起始位置回到平衡点的过程。各状态变 量的仿真结果如图 4 所示,各输入量的仿真结果如图 5 所 示。 由图 4 和图 5 可知,机器人在 1 s 左右回到平衡点并保 持平衡状态。此过程中的车体位移在 0.2 m 左右,同时对转
· 31 ·


自动化应用 第 5 期
自动控制系统
向运动的影响非常小。左右驱动轮所需的回复力矩不超过 3.5 N·m,在所选电机的峰值扭矩范围内,满足实际要求。
0 1 2 3 4 5 6 7 8 9 10 时间/s (a)车体位移
0.25
0.20
0.15
0.10
0.05
0
0 1 2 3 4 5 6 7 8 9 10 时间/s (b)俯仰角度
20
15
10
5
0
-15
0 1 2 3 4 5 6 7 8 9 10 时间/s (c)旋转角度
2 0 -2 -4 -6 -8 -10 -12 -16 -18 0 1 2 3 4 5 6 7 8 9 10 时间/s (d)车体速度
0.5
0.4
0.3
0.2
0.1
0
0 1 2 3 4 5 6 7 8 9 10 时间/s (e)俯仰角速度
0
-0.5
-1
-1.5
-2
0 1 2 3 4 5 6 7 8 9 10 时间/s (f)转向角速度
5
0
-5
-10
-15
车体位移/m
俯仰角度/(°)
俯仰角速度/(rad/s) 旋转角度/(°)
转向角速度/(rad/s) 车体速度/(m/s)
图 4 初始俯仰角 20°时各状态变量的仿真结果
0 1 2 3 4 5 6 7 8 9 10 时间/s (a)左轮力矩
-32100.....4535251505
0 1 2 3 4 5 6 7 8 9 10 时间/s (b)右轮力矩
-32100.....4535251505
右轮力矩/(N·m) 左轮力矩/(N·m)
图 5 初始俯仰角 20°时各输入量的仿真结果
3 VMC 解算
3.1 正运动学解算
五连杆机构参数定义如图 6 所示。其中,A、E 两转动 副由电机驱动,其角度 φ1、φ4 可通过电机编码器测得。在 控制任务中主要关注五连杆机构末端 C 点的位置,通常可 用直角坐标(x,y)或极坐标(L0,φ0)表示。 通过五连杆左右两部分列写 C 点坐标,可得到:
■■■
x
B+l2 cos φ2=xD +l3 cos φ3
y
B + l2 sin φ2 = yD + l3 sin φ3
(14)
求解方程组可得到角度 φ2:
φ
2=2arctan( )
B
0+ A2
0+B2
0-C2
0
A
0+C0
(15)
其中, A
0 = 2l2(xD - xB) (16)
B
0 = 2l2(yD - yB) (17)
C
0=l2
2+l2
BD - l2
3 (18)
l
BD = (xD - xB)2 +(yD - yB)2 (19)
通过角度 φ2 可解算出 C 点的直角坐标(x,y):
■■■
xC=l1 cos φ1+l2 cos φ2 yC = l1 sin φ1 + l2 sin φ2
(20)
图 6 五连杆机构
3.2 VMC 雅可比矩阵
虚拟模型控制(Virtual Model Control,VMC)[6]是一种 直觉控制方式,其关键是在每个需要控制的自由度上构造 恰当的虚拟构件以产生合适的虚拟力。虚拟力不是实际执 行机构的作用力或力矩,而是通过执行机构的作用转换而 形成。为了将工作空间的力或力矩映射成关节空间的关节 力矩,需要得到这两个空间的位置映射关系,即正运动学 模型:
x=f ( q ) (21)
式中:x=[ ]
L
0 φ0
T,q=[ ]
φ
1 φ4
T。求 x 全微分得:
■
■
■
||
|||
δL0= ∂f1
∂φ1
δφ1+ ∂f1
∂φ4
δφ4
δφ0= ∂f2
∂φ1
δφ1+ ∂f2
∂φ4
δφ4
(22)
即:
δx =
■
■
|
|
|
|||
|
|■
■
|
|
|
|||
|
|
∂f1
∂φ1
∂f1
∂φ4
∂f2
∂φ1
∂f2
∂φ4
δq (23)
定义雅可比矩阵 J 为:
J=
■
■
|
|
|
|||
|
|■
■
|
|
|
|||
|
|
∂f1
∂φ1
∂f1
∂φ4
∂f2
∂φ1
∂f2
∂φ4
(24)
· 32 ·


自动化应用
第 5 期 自动控制系统
有:
δx=Jδq (25) 通过雅可比矩阵 J 将关节速度 q 映射为五连杆姿态 变化率 x。根据虚功原理,有:
T T δq+(-F)T δx=0 (26)
式中:T=[ ]
T
1T2
T 为前后两关节电机输出力矩列向量,F=
[]
FTp
T 为腿部五连杆机构沿腿的推力 F 与沿中心轴的力
矩 Tp 构成的列向量。将式(25)代入,有:
T=JTF (27) 综上,通过正运动学模型雅可比矩阵即可解算出关节 电机输出力矩。要想得到机器人腿长 L0,则需对机器人腿 部平面五杆机构进行正运动学解算。而在轮腿倒立摆模型 中,则需要运用 VMC,并根据 Tp 获得两关节的电机输出扭 矩。
4 关节电机
由于轮腿式平衡机器人没有被动悬挂,其避震效果全 靠五连杆的轮腿来实现,所以关节电机需要具备较大的输 出力矩。通过上述动力学建模和 MATLAB 建模分析,同时 综合考虑各种算法,最终本项目选择了海泰 HT-03 型号 的关节电机(见图 7),其扭矩为 6.5 N·m,满足使用要求。
图 7 海泰 HT-03 电机
5 结语
本文主要介绍了轮腿式平衡机器人的数学模型,将五 连杆机构引入了轮腿机器人中,应用基于输出调节和 LQR 方法的线性反馈控制器,采用 VMC 算法设计了腿部运动 控制器。设计过程均是先根据动力学方程建立控制模型, 再使用 Simulink 搭建控制方框图进行仿真计算,根据仿真 结果调整控制参数,最后分析本系统在该参数下的控制效 果,保障机器人在各个高度下均能实现良好的控制效果。 腿部控制过程的系统性分析为实现本倒立摆机器人 系统提供了完整的理论分析,也为后续搭建轮腿机器人的 硬件系统、进一步的软件分析及系统优化奠定了一定的理 论基础。
参考文献
[1]佚名 . 腾讯轮腿式机器人“Ollie”升级增加触觉感知功能[J]. 机器人技术与应用,2022(5):8.
[2]Akesson J, Blomdell A, Braun R. Design and control of
YAIP — an inverted pendulum on two wheels robot[C]// IEEE
International Symposium on Computer Aided Control
SystemDesign, IEEE International Conference on Control
Applications. IEEE,2006.
[3]刘帅帅 . 新型两轮轮腿式自平衡机器人研究[D]. 杭州:浙江
农林大学,2023. [4]陈阳,王洪玺,张兰勇 . 轮腿式平衡机器人控制[J]. 信息与控
制,2023,52(5):648-659.
[5]于红英,唐德威,王建宇 . 平面五杆机构运动学和动力学特性 分析[J]. 哈尔滨工业大学学报,2007,39(6):940-943. [6]贺回国 . 基于 VMC 的四足机器人运动控制仿真及参数分析 [D]. 太原:太原科技大学,2023.
· 33 ·